# Web Exploitation  

## SOAP  
<img width="436" alt="image" src="https://github.com/user-attachments/assets/cbefdb2c-98f3-4958-81c0-6a810d609b20" />   


The home page looked like:  
<img width="944" alt="image" src="https://github.com/user-attachments/assets/4af75c30-36c4-4e67-a2c4-4aa1ac94f20b" />   

This challenge makes use of **XML external entities(XXE) injection** to get the flag.  
>**External Entity**: If an entity is declared outside a DTD(Document Type Definition), it is called an external entity. Here, it is identified by `SYSTEM`.
> Syntax: `<!ENTITY entity_name SYSTEM "entity_value">`   

>**XML External Entities injection** is a type of attack against an application that parses XML input and allows XML entities.  

To **test for XXE**, we can inject malicious payload by sending the XML payload with an external entity reference and observe if sensitive data is returned in the response.    
>Now, a **Payload** refers to the data/code sent to a target system to achieve a specific result, often during exploitation or testing vulnerabilities.


Here, I made use of **Burp Suite app** to check and modify responses.  

Initially, opened the Chromium browser through the app for opening the site. Then switched on **intercept** to recieve the requests.  
<img width="960" alt="image" src="https://github.com/user-attachments/assets/224e7421-3559-492f-935f-1a070d6ada7e" />  

Now, sent the request to the Repeater for saving and also to make changes. On seeing the response,  
<img width="960" alt="image" src="https://github.com/user-attachments/assets/df29d736-56ad-4ef2-a0b1-5ef0d1c11bf3" />  

I tried to change numbers from 2 to 1, 0 and 3. On putting 0, we see an invalid ID. While on putting 1 and 3, we see those messages as seen on the website.  
<img width="713" alt="image" src="https://github.com/user-attachments/assets/c314f808-3173-4060-b686-d7015f182efe" />  

This gave another hint to use the XXE injection technique here.  
Went through some resources on Payloads, and how to use them https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md#tools.  

I detected the vulnaribility, which was by changing the ID, now the next step I did was as follows:  
I defined entities inside the `DOCTYPE` element. I added the underneath code and made some changes:  
`<!DOCTYPE replace [<!ENTITY example "0"> ]>`  

<img width="711" alt="image" src="https://github.com/user-attachments/assets/5f3b76f2-9e69-4b71-bcc1-084f35be15f5" />   

Changed the ID from 0 to `&example`, as the entity name is example here.  
Similarly, if changed 0 to 1, we can see the response matches output of the website(that we did earlier).  

<img width="716" alt="image" src="https://github.com/user-attachments/assets/024f1350-2c1e-4913-9dbd-b21cf62919b9" />    

So now I changed the number to the path of the /etc/passwd file.  
`<!DOCTYPE root [<!ENTITY test SYSTEM 'file:///etc/passwd'> ]>`  
This defines an external entity named `test`. `SYSTEM` is again a keyword that says entity recieves data fromm external source.  
The `&test;` refers to the entity defined earlier. When processed, the XML parser replaces &test; with the content of the /etc/passwd file(conatining sensitve info).  

On sending the request, we recieve the response that contains the flag!!  
**`picoCTF{XML_3xtern@l_3nt1t1ty_0e13660d}`**  

<img width="713" alt="image" src="https://github.com/user-attachments/assets/fa6297d6-ad4a-4dac-8e15-7980da8c55de" />  


















